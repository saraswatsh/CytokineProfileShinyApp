<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Understanding (s)PLS-DA • CytokineProfileShinyApp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Understanding (s)PLS-DA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytokineProfileShinyApp</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/saraswatsh/CytokineProfileShinyApp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Understanding (s)PLS-DA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/saraswatsh/CytokineProfileShinyApp/blob/master/vignettes/Understanding-sPLS-DA.Rmd" class="external-link"><code>vignettes/Understanding-sPLS-DA.Rmd</code></a></small>
      <div class="d-none name"><code>Understanding-sPLS-DA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="sparse-partial-least-squares-discriminant-analysis-spls-da">Sparse Partial Least Squares Discriminant Analysis (sPLS-DA)<a class="anchor" aria-label="anchor" href="#sparse-partial-least-squares-discriminant-analysis-spls-da"></a>
</h2>
<p>Sparse Partial Least Squares Discriminant Analysis (sPLS-DA) is a
supervised multivariate method that projects samples into new components
that best separate predefined groups while selecting a small set of
discriminative variables (features). This page shows how to interpret
the main figures produced by the app and how to reproduce them.</p>
</div>
<div class="section level2">
<h2 id="example-results-cd3cd28-treatment">Example Results: CD3/CD28 Treatment<a class="anchor" aria-label="anchor" href="#example-results-cd3cd28-treatment"></a>
</h2>
<p>For this brief interpretation tutorial, we will use the results
generated using the CD3/CD28 treatment condition from the
<code>ExampleData1</code> dataset built into the application. The groups
compared in this example are Non-diabetic (ND), Pre-Diabetic (PreT2D),
and Type 2 Diabetes (T2D).</p>
<div class="section level3">
<h3 id="d-component-scores-classification-plot">2D Component Scores (Classification) Plot<a class="anchor" aria-label="anchor" href="#d-component-scores-classification-plot"></a>
</h3>
<p><img src="../reference/figures/splsda_results_Page_1.png"></p>
<p>This plot shows us the classification of the groups chosen for
comparison. Generally, we would look for any clustering or separation of
the groups. Ellipses seen in this figure are based on a 95% confidence
region, so there may be overlap however less overlap suggests better
discrimination. A better way to see discrimination would be to use the
option for <code>shaded background prediction</code>, however it takes a
bit longer due to computational time. The axis labels show the variance
explained by the component 1 in the x-axis (39% in this example) and
component 2 in the y-axis (33% in this example). The title of the plot
displays the model accuracy which can provide a surface level view of
the classification done by the model. In our case the model accuracy is
55.6% in classifying the three different groups which is not great as it
is almost by chance. An accuracy of ≥ 70% is generally acceptable as it
shows good discrimination.</p>
</div>
<div class="section level3">
<h3 id="loadings-plot---component-1">Loadings Plot - Component 1<a class="anchor" aria-label="anchor" href="#loadings-plot---component-1"></a>
</h3>
<p><img src="../reference/figures/splsda_results_Page_4.png"></p>
<p>The loadings plot show the variables driving the separation along the
first component. The loadings plot show the magnitude of the loadings
(seen by the scale at the bottom). The signs, whether negative or
positive are of direction relative to the component’s score and should
not be interpreted as a p-value would and should be interpreted as to
how strong the contribution of those features are in the model. To make
interpretation easy, we can think about taking the absolute value of the
loadings, for example in our plot we see that cytokine IFN-G has a
magnitude of ≈ -0.4. Based on this, the |-0.4| magnitude would be 0.4
which would still make it the cytokine with the strongest contribution
to the model associated with T2D. Similarly, cytokine IL-31 is the 3rd
strongest contributor to the model associated with PreT2D group with a
magnitude of 0.3.</p>
</div>
<div class="section level3">
<h3 id="variable-importance-in-projection-vip-scores---component-1">Variable Importance in Projection (VIP) Scores - Component 1<a class="anchor" aria-label="anchor" href="#variable-importance-in-projection-vip-scores---component-1"></a>
</h3>
<p><img src="../reference/figures/splsda_results_Page_5.png"></p>
<p>VIP scores are another way to measure the most influential cytokines
in the model. Once again, we can see the same cytokines that we saw in
the loadings plot as the stronger contributors to have high VIP scores.
A general rule of thumb is that variables with VIP scores &gt; 1 are
considered to be the most influential (Tenenhaus 1998), which are used
for a second sPLS-DA model to determine if the classification is
improved. The secondary model is omitted from this tutorial.</p>
</div>
<div class="section level3">
<h3 id="receiver-operating-characteristic-roc-curve-and-area-under-the-curve-auc">Receiver Operating Characteristic (ROC) Curve and Area Under the
Curve (AUC)<a class="anchor" aria-label="anchor" href="#receiver-operating-characteristic-roc-curve-and-area-under-the-curve-auc"></a>
</h3>
<p><img src="../reference/figures/splsda_results_Page_2.png"></p>
<p>The ROC curve and AUC value is a great way to evaluate the model’s
performance as the curve plots the true positive rate (sensitivity)
against the false positive rate (1-specificity). The AUC value provides
a single measure of a model’s ability to discriminate between classes,
with values closer to 1 indicating better performance. In our example,
the comparison of PreT2D vs Others shows us the best discrimination of
the model with an AUC value of 0.8. Since it is a multiclass comparison,
the AUC value is treated as one group versus all the others combined
(i.e. PreT2D vs. Others (ND +T2D)). Therefore, PreT2D has a fairly
distinct profile compared with the combined ND+T2D group and the model
is reasonably good at discriminating PreT2D from the other groups.</p>
</div>
<div class="section level3">
<h3 id="cross-validation-performance">Cross-Validation Performance<a class="anchor" aria-label="anchor" href="#cross-validation-performance"></a>
</h3>
<p><img src="../reference/figures/splsda_results_Page_3.png"></p>
<p>The sPLS-DA method in the application offers two different types of
cross-validation methods; Leave-One-Out (LOOCV) and M-fold
cross-validation. These methods are also used to evaluate the
performance of the model alongside the ROC curve and AUC as sPLS-DA is
prone to overfitting especially when working with small sample size and
large number of variables.</p>
<p>Difference between LOOCV and M-fold cross-validation:</p>
<ul>
<li><p>LOOCV: This method involves training the model on all data points
except one, and then testing it on that single left-out data point. This
process is repeated for every data point, and the results are averaged.
LOOCV is computationally intensive but provides a nearly unbiased
estimate of the model’s performance, especially useful for small
datasets.</p></li>
<li><p>M-fold Cross-Validation: In M-fold cross-validation (e.g., 5-fold
or 10-fold), the dataset is randomly divided into M equally sized
subsets (folds). The model is trained on M-1 folds and validated on the
remaining fold. This process is repeated 100 times, with each fold
serving as the validation set exactly once. The results from each fold
are then averaged to produce a single performance estimate.</p></li>
</ul>
<p>In our example, we can see that the LOOCV error rate is plotted
across the first 2 components. The error rate is the rate of
misclassification in the model which in our case LOOCV shows an error
rate of approximately 49.5%. This is can be also reworded as, LOOCV
shows us an accuracy of 50.5%, which is similar to our overall model
accuracy that we saw earlier in the 2D classification plot.</p>
</div>
<div class="section level3">
<h3 id="below-is-a-short-animation-on-how-to-obtain-the-same-result-from-the-application">Below is a short animation on how to obtain the same result from the
application:<a class="anchor" aria-label="anchor" href="#below-is-a-short-animation-on-how-to-obtain-the-same-result-from-the-application"></a>
</h3>
<p><img src="../reference/figures/sPLS-DA.gif"></p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Tenenhaus, M. (1998). La regression PLS: theorie et pratique. Paris:
Editions Technic.</p>
<hr>
<p><em>Last updated:</em> November 04, 2025</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shubh Saraswat, Xiaohua Douglas Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
