% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cyt_plsr.R
\name{cyt_plsr}
\alias{cyt_plsr}
\title{Perform Partial Least Squares Regression (PLSR) or sparse PLSR (sPLSR) analysis}
\usage{
cyt_plsr(
  data,
  response_col,
  group_col = NULL,
  ind_names = FALSE,
  comp_num = 2,
  sparse = FALSE,
  var_num = NULL,
  cv_opt = NULL,
  fold_num = 5,
  scale = NULL,
  ellipse = FALSE,
  pls_colors = NULL,
  output_file = NULL,
  progress = NULL
)
}
\arguments{
\item{data}{A data frame containing the predictor and response variables.}

\item{response_col}{The name of the column containing the response variable.
Must be numeric.}

\item{group_col}{The name of the column to use for grouping samples in the
score plot. If \code{NULL}, no grouping is applied.}

\item{ind_names}{Logical, or a character vector. If \code{TRUE}, sample names are
displayed on the plot. If a character vector, these names are used.}

\item{comp_num}{The number of components to use in the PLSR model.}

\item{sparse}{Logical. If \code{TRUE}, performs sparse PLSR (sPLSR).}

\item{var_num}{The number of variables to keep per component for sPLSR.
Required if \code{sparse = TRUE}.}

\item{cv_opt}{Character string specifying the cross-validation option:
"None", "LOOCV" (Leave-One-Out Cross-Validation), or "Mfold" (M-fold
Cross-Validation).}

\item{fold_num}{The number of folds for M-fold cross-validation. Only
applicable if \code{cv_opt = "Mfold"}.}

\item{scale}{Character string. If "log2", applies log2 transformation to
numeric predictor columns.}

\item{ellipse}{Logical. If \code{TRUE}, draws 95\% confidence ellipses on the
score plot.}

\item{pls_colors}{A character vector of colors to use for grouping.}

\item{output_file}{Optional. A file path to save the plots as a PDF.}

\item{progress}{Optional. A Shiny \code{Progress} object for reporting progress updates.}
}
\value{
A list containing:
\item{scores_plot}{A recorded plot of the PLSR scores.}
\item{pred_vs_obs}{A recorded plot of predicted vs. observed response values.}
\item{residuals_plot}{A recorded plot of residuals vs. fitted values.}
\item{cv_plot}{A recorded plot of cross-validation performance (Q2 and RMSEP), if \code{cv_opt} is not "None".}
\item{loadings}{A list of recorded plots for loadings of each component.}
\item{vip_scores}{A list of \code{ggplot} objects of VIP scores for each component.}
\item{vip_scores_indiv}{A recorded plot of the PLSR scores for variables
with VIP > 1, if applicable.}
\item{vip_cv_plot}{A recorded plot of cross-validation performance for
variables with VIP > 1, if applicable.}
\item{metrics_text}{Text summary of Q2 values, if available.}
\item{pdf_file}{The path to the generated PDF file, if \code{output_file} was
provided.}
}
\description{
This function wraps the mixOmics \code{pls()} and \code{spls()} functions to perform
regression of one or more response variables on a set of predictors.
It automatically handles optional log2 scaling, extraction of numeric columns
and grouping information, and returns a small list of recorded plots for
display in Shiny.  The first plot (\code{indiv_plot}) is a score plot of the
first two latent components colored by a grouping variable (if provided).
The second plot (\code{pred_plot}) is a scatterplot of the observed vs predicted
response values for the first response variable.  Additional plots could
easily be added (e.g. loadings), but these two provide basic diagnostics.
}
