% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cyt_splsda.R
\name{cyt_splsda}
\alias{cyt_splsda}
\title{Analyze data with Sparse Partial Least Squares Discriminant Analysis (sPLS-DA).}
\usage{
cyt_splsda(
  data,
  group_col,
  group_col2 = NULL,
  batch_col = NULL,
  multilevel_col = NULL,
  var_num,
  comp_num = 2,
  cv_opt = NULL,
  fold_num = 5,
  scale = NULL,
  ellipse = FALSE,
  bg = FALSE,
  roc = FALSE,
  conf_mat = FALSE,
  style = NULL,
  splsda_colors = NULL,
  pch_values = NULL,
  output_file = NULL,
  progress = NULL
)
}
\arguments{
\item{data}{A matrix or data frame containing the variables. Columns not
specified by \code{group_col}, \code{group_col2}, or \code{multilevel_col} are assumed to be continuous
variables for analysis.}

\item{group_col}{A string specifying the first grouping column name that contains grouping
information. If \code{group_col2} is not provided, it will be used for both
grouping and treatment.}

\item{group_col2}{A string specifying the second grouping column name. Default is
\code{NULL}.}

\item{batch_col}{A string specifying the column that identifies the batch or study for each sample.}

\item{multilevel_col}{A string specifying the column name that identifies
repeated measurements (e.g., patient or sample IDs). If provided, a
multilevel analysis will be performed. Default is \code{NULL}.}

\item{var_num}{Numeric. The number of variables to be used in the PLS-DA model.}

\item{comp_num}{Numeric. The number of components to calculate in the sPLS-DA model.
Default is 2.}

\item{cv_opt}{Character. Option for cross-validation method: either "loocv" or "Mfold".
Default is \code{NULL}.}

\item{fold_num}{Numeric. The number of folds to use if \code{cv_opt} is "Mfold". Default is 5.}

\item{scale}{Character. Option for data transformation; if set to \code{"log2"}, a log2
transformation is applied to the continuous variables. Default is \code{NULL}.}

\item{ellipse}{Logical. Whether to draw a 95\\% confidence ellipse on the figures.
Default is \code{FALSE}.}

\item{bg}{Logical. Whether to draw the prediction background in the figures.
Default is \code{FALSE}.}

\item{roc}{Logical. Whether to compute and plot the ROC curve for the model.
Default is \code{FALSE}.}

\item{conf_mat}{Logical. Whether to print the confusion matrix for the classifications.
Default is \code{FALSE}.}

\item{style}{Character. If set to \code{"3D"} or \code{"3d"} and \code{comp_num} equals 3,
a 3D plot is generated using the \code{plot3D} package. Default is \code{NULL}.}

\item{splsda_colors}{A vector of splsda_colors for the groups or treatments. If
\code{NULL}, a random palette (using \code{rainbow}) is generated based on
the number of groups.}

\item{pch_values}{A vector of integers specifying the plotting characters (pch values)
to be used in the plots.}

\item{output_file}{A string specifying the file name for saving the PDF output.
If set to NULL, the function runs in interactive mode.}
}
\value{
In Download mode (output_file not NULL), a PDF file is written and the function
returns NULL invisibly. In Interactive mode (output_file = NULL), a named list is
returned with the following elements (in this order):
1. overall_indiv_plot: Main individual classification plot
2. overall_3D: Main 3D plot (if generated)
3. overall_ROC: ROC curve plot for the overall model
4. overall_CV: Cross-validation error plot for the overall model
5. loadings: A list of loadings plots (one per component)
6. vip_scores: A list of VIP score bar plots for each component
7. vip_indiv_plot: Main individual plot for the VIP>1 model
8. vip_3D: 3D plot for the VIP>1 model (if generated)
9. vip_ROC: ROC curve plot for the VIP>1 model
10. vip_CV: Cross-validation error plot for the VIP>1 model
11. conf_matrix: Confusion matrix text output
}
\description{
Analyze data with Sparse Partial Least Squares Discriminant Analysis (sPLS-DA).
}
\examples{
data_df <- ExampleData1[,-c(3)]
data_df <- dplyr::filter(data_df, Group != "ND", Treatment != "Unstimulated")

cyt_splsda(data_df, output_file = NULL,
splsda_colors = c("black", "purple"), bg = FALSE, scale = "log2",
conf_mat = FALSE, var_num = 25, cv_opt = NULL, comp_num = 2,
pch_values = c(16, 4), style = NULL, ellipse = TRUE,
group_col = "Group", group_col2 = "Treatment", roc = FALSE)

}
